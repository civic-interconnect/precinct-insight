<!doctype html>
<html lang="en">

<head>
  <!-- 1. Metadata: character encoding, compatibility, language, viewport -->
  <meta charset="UTF-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- 2. Title for faster rendering of tab content -->
  <title>Precinct Insight (MN)</title>

  <!-- 3. SEO: canonical, description, keywords, author -->
  <link rel="canonical" href="https://civic-interconnect.github.io/geo-explorer/">
  <meta name="description" content="Civic Connect GeoExplorer for exploring civic boundaries.">
  <meta name="keywords" content="Civic Interconnect, Boundaries">
  <meta name="author" content="Civic Interconnect">

  <!-- 4. Web app / PWA metadata -->
  <meta name="theme-color" content="#007acc">
  <meta name="msapplication-TileColor" content="#4169E1">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta property="og:title" content="Civic Interconnect - GeoExplorer">
  <meta property="og:description" content="Explore civic boundaries with interactive maps">

  <!-- 5. Preconnect & preload critical resources -->
  <link rel="preconnect" href="https://tile.openstreetmap.org">
  <link rel="dns-prefetch" href="https://a.tile.openstreetmap.org">
  <link rel="dns-prefetch" href="https://b.tile.openstreetmap.org">
  <link rel="dns-prefetch" href="https://c.tile.openstreetmap.org">
  <link rel="preconnect" href="https://unpkg.com">

  <!-- 6. Icons and manifest (smallest to largest) -->
  <link rel="icon" href="./favicon.ico" crossorigin="anonymous">
  <link rel="icon" type="image/png" sizes="16x16" href="./favicon_io/favicon-16x16.png" crossorigin="anonymous">
  <link rel="icon" type="image/png" sizes="32x32" href="./favicon_io/favicon-32x32.png" crossorigin="anonymous">
  <link rel="apple-touch-icon" sizes="180x180" href="./favicon_io/apple-touch-icon.png" crossorigin="anonymous">
  <link rel="manifest" href="./manifest.json" crossorigin="anonymous">

  <!-- 7. Leaflet CSS and JS - Load immediately since they're critical -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <!-- 8. Fonts & CSS -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="./styles/style.css" as="style" onload="this.onload=null;this.rel='stylesheet';">

  <noscript>
    <link rel="stylesheet" href="./styles/app.css" type="text/css" media="all">
    <p style="padding: 2rem; color: red;">
      This application requires JavaScript to run.
    </p>
  </noscript>

</head>

<body>
  <div id="app">
    <aside id="panel">
      <header>
        <h1>Precinct Insight</h1>
        <p class="sub">Minnesota Prototype</p>
      </header>

      <section id="controls">
        <label>Year
          <select id="year-select">
          </select>
        </label>

        <label>Office
          <select id="office-select">
            <option value="POTUS">President</option>
            <option value="US_SENATE">U.S. Senate</option>
            <option value="US_HOUSE">U.S. House</option>
          </select>
        </label>

        <label>Metric
          <select id="metric-select">
            <option value="turnout_pct">Turnout %</option>
            <option value="dem_share">DEM share %</option>
            <option value="gop_share">GOP share %</option>
            <option value="margin">Margin (DEM - GOP)</option>
          </select>
        </label>

        <label>County
          <select id="county-select"></select>
        </label>

        <label>MN Senate District
          <select id="mn-senate-district-select"></select>
        </label>

        <label>MN House District
          <select id="mn-house-district-select"></select>
        </label>

        <label>Find precinct
          <input id="precinct-search" type="text" placeholder="Type name..." />
        </label>
      </section>

      <section id="cards">
        <div class="card">
          <div class="k">Turnout</div>
          <div id="kpi-turnout" class="v">--</div>
        </div>
        <div class="card">
          <div class="k">DEM</div>
          <div id="kpi-dem" class="v">--</div>
        </div>
        <div class="card">
          <div class="k">GOP</div>
          <div id="kpi-gop" class="v">--</div>
        </div>
        <div class="card">
          <div class="k">Margin</div>
          <div id="kpi-margin" class="v">--</div>
        </div>
      </section>

      <section id="details">
        <h2>Precinct</h2>
        <div id="detail-body">Click a precinct...</div>
      </section>

      <footer>
        <small>Data: public election results, precinct boundaries. Map tiles: OpenStreetMap contributors. </small>
      </footer>

      <ci-footer site-url="https://civic-interconnect.github.io/precinct-insight/"
        source-url="https://github.com/civic-interconnect/precinct-insight">
      </ci-footer>
    </aside>

    <main id="map"></main>

  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="" crossorigin=""></script>
  <script>
    if (
      "serviceWorker" in navigator &&
      location.hostname !== "127.0.0.1" &&
      location.hostname !== "localhost"
    ) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>

  <script defer type="module" src="./js/app.js"></script>

</body>

</html>